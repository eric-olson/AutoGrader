<div class="row" style="height: 500px;">
  <div class="col-md-12">
    <h4>Test Results</h4>
    <div id="progress_bar" class="progress progress-bar-segmented">
    </div>
  </div>
  <div class="col-md-4">
    <div class="panel panel-default">

      <div class="panel-heading">
        <h3 class="panel-title"><%= @assignment.name %></h3>
      </div>
      <div class="panel-body">
        <p><%= @assignment.description %></p>

        <div class="btn-group btn-group-justified" role="group" aria-label="...">
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default">Restart</button>
          </div>

          <div class="btn-group" role="group" id="test_btn">
            <button type="button" class="btn btn-default">Test</button>
          </div>

          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default">Save</button>
          </div>

          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default">Submit</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-8">

    <ul class="nav nav-tabs">
      <li class="active">
        <a href="#1" data-toggle="tab">Write</a>
      </li>
      <li>
        <a href="#2" data-toggle="tab">Upload</a>
      </li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane active" id="1">
      <style type="text/css" media="screen">
      #editor {
        height: 300px;
      }

      </style>

      <div id="editor"><%= @spec_file_contents %></div>

      <script>
      var editor = ace.edit("editor");
      $( document ).ready(function() {
        editor.setTheme("ace/theme/chrome");
        editor.getSession().setMode("ace/mode/c_cpp");
      });

      $('#test_btn').on('click', function() {
        $.ajax({
          type: 'post',
          url: 'testCode',
          data: {editor_text:editor.getValue(),id:<%=@assignment.id%>},
          success: function(response) {
            // Load the progress bar with the html from the response
            $('#progress_bar').html(response.progress_bar_html);
            // Enable popovers
            $('[data-toggle="popover"]').popover();

            // Load the erros with runtime and compile errors
            runtime_and_compile_errors = "Compile Errors:\n" + response.compile_errors + "\n\nRuntime Errors:\n" + response.runtime_errors;
            $('#test_output').html(runtime_and_compile_errors);

          }
        });
        return false;
      });
      </script>
    </div>

    <div class="tab-pane" id="2">
      <p>Interface to upload code</p>
    </div>

  </div>
  <h2>Errors</h2>
  <textarea id="test_output" class="panel panel-default" style="width: 100%;height:200px;font-family: monospace;">Press 'Test' to run the unit tests. Any runtime or compiler errors will appear here.</textarea>
</div>
</div>
